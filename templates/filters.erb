filter {

	if [type] == "auth" or [type] == "syslog" {
		grok {
			match => {
				"message" => "%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}"
			}
		}
		date {
			match => [ "syslog_timestamp", "MMM  d HH:mm:ss", "MMM dd HH:mm:ss" ]
		}
	}

	# if [type] == "apache-access" {
	# 	grok {
	# 		match => {
	# 			"message" => "%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}"
	# 		}
	# 	}
	# 	date {
	# 		match => [ "syslog_timestamp", "MMM  d HH:mm:ss", "MMM dd HH:mm:ss" ]
	# 	}
	# }

	# CPU
	# Need to increment core value
	PUTVAL %{HOSTNAME:hostname}/cpu-%{INT:core}/cpu-%{DATA:type} interval=%{NUMBER:interval} %{NUMBER:timestamp}:%{NUMBER:jiffies}

	# DF
	# Need to convert bytes to MB and replace '-' in partition
	PUTVAL %{HOSTNAME:hostname}/df-%{DATA:partition}/df_%{DATA:type} interval=%{NUMBER:interval} %{NUMBER:timestamp}:%{NUMBER:bytes}

	# Memory
	# Need to convert bytes to MB
	PUTVAL %{HOSTNAME:hostname}/df-%{DATA:partition}/df_%{DATA:type} interval=%{NUMBER:interval} %{NUMBER:timestamp}:%{NUMBER:bytes}

	# Disk
	# Need to convert bytes to MB (Only for Octets)
	# Need to convert ms to s (Only for Time)
	PUTVAL %{HOSTNAME:hostname}/disk-%{DATA:partition}/disk_%{DATA:type} interval=%{NUMBER:interval} %{NUMBER:timestamp}:%{NUMBER:read}:%{NUMBER:write}

	# Interface
	# traffic is in octets/s
	# packets in packets/s
	PUTVAL %{HOSTNAME:hostname}/interface-%{DATA:interface}/if_%{DATA:type} interval=%{NUMBER:interval} %{NUMBER:timestamp}:%{NUMBER:rx}:%{NUMBER:tx}

	# Load
	PUTVAL %{HOSTNAME:hostname}/load/load interval=%{NUMBER:interval} %{NUMBER:timestamp}:%{NUMBER:average_15m}:%{NUMBER:average_5m}:%{NUMBER:average_1m}

}
